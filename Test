-- LocalScript

local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local ShootEvent = ReplicatedStorage:WaitForChild("Events"):WaitForChild("Shoot")

-- Get the local player
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local shootButton = playerGui:WaitForChild("Mobile"):WaitForChild("Offense"):WaitForChild("Shoot")

-- Fire instant double shot
local function FireInstantDoubleShot()
    ShootEvent:FireServer(true, 100, nil, false)
    task.delay(0.5, function()
        ShootEvent:FireServer(false, -0.98, true)
    end)
end

-- Disable any existing scripts in the Shoot button
for _, v in pairs(shootButton:GetDescendants()) do
    if v:IsA("Script") or v:IsA("LocalScript") then
        v.Disabled = true
    end
end

-- Disconnect all existing events from the Shoot button
local function disconnectAllEvents(object)
    for _, conn in pairs(getconnections(object.MouseButton1Click)) do
        conn:Disconnect()
    end
    for _, conn in pairs(getconnections(object.Activated)) do
        conn:Disconnect()
    end
end

pcall(disconnectAllEvents, shootButton)

-- Hook button input
local isHolding = false

shootButton.MouseButton1Down:Connect(function()
    isHolding = true
    FireInstantDoubleShot()
end)

shootButton.MouseButton1Up:Connect(function()
    isHolding = false
end)

-- Optional: Trigger via keyboard
UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.E then
        FireInstantDoubleShot()
    end
end)
